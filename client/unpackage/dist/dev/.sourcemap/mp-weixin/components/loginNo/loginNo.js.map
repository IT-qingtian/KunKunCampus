{"version":3,"sources":["webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?deac","webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?4485","webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?7c52","webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?5a18","uni-app:///components/loginNo/loginNo.vue","webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?74d8","webpack:///C:/Users/87634/Desktop/KunKunCampus/client/components/loginNo/loginNo.vue?fefb"],"names":["data","computed","methods","login","uni","success","console","code","url","method","resLogin","token","fail","get_subscribeMessage","tmplIds","resolve","mounted"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;AACc;;;AAGpE;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAimB,CAAgB,2nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACsBrnB;AAAA;AAAA;AAAA,eAEA;EACAA;IACA;EACA;EACAC,4BACA,2EACA;EACAC,yCACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAEA;gBACAC;kBACAC;oBACAC;oBACA;oBACAF;sBACAC;wBAAA;0BAAA;0BAAA;4BAAA;8BAAA;gCAAA;kCACA;kCACAE;kCAAA;kCAAA,OACAH;oCACAI;oCACAC;oCACAT;sCAAAO;oCAAA;kCACA;gCAAA;kCAJAG;kCAKA;kCAAA,iBACAA;kCAEAJ;kCACA;oCACA;oCACAK;oCACA;;oCAEA;oCACA;;oCAEA;oCACAP;kCACA;oCACAA;kCACA;gCAAA;gCAAA;kCAAA;8BAAA;4BAAA;0BAAA;wBAAA,CACA;wBAAA;0BAAA;wBAAA;wBAAA;sBAAA;sBACAQ;wBAAA;sBAAA;oBACA;kBACA;kBACAA;oBACAR;oBACAE;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;IACAO;MAAA;MACA;QACAP;QAEAF;UACAU;UACAT;YACAC;YACAS;UACA;UACAH;YACAN;YACAS;UACA;QACA;MACA;IACA;EAAA,EACA;EACAC,6BACA;AACA;AAAA,2B;;;;;;;;;;;;;ACnGA;AAAA;AAAA;AAAA;AAA4oC,CAAgB,knCAAG,EAAC,C;;;;;;;;;;;ACAhqC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/loginNo/loginNo.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./loginNo.vue?vue&type=template&id=266af21a&\"\nvar renderjs\nimport script from \"./loginNo.vue?vue&type=script&lang=js&\"\nexport * from \"./loginNo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./loginNo.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/loginNo/loginNo.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./loginNo.vue?vue&type=template&id=266af21a&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./loginNo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./loginNo.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"content\">\n    <!-- 头像区 -->\n    <view class='header'>\n      <image class='headImg' src='../../static/my/head.jpg'></image>\n      <text>坤坤校园</text>\n\n    </view>\n    <!--  主体区-->\n    <!-- <text>没登录</text> -->\n    <view class=\"container\">\n      <button type=\"primary\" @click='login'>微信一键登陆</button>\n      <view class=\"text\">\n        <text>申请获得权限，以此登陆小程序使用服务。</text>\n        <br>\n        <text>一个只为自贡职业技术学院服务的小程序。</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport {mapMutations, mapState} from 'vuex'\n\nexport default {\n  data() {\n    return {}\n  },\n  computed: {\n    ...mapState('store_user', ['token', 'subscribeMessages_templIDs']),\n  },\n  methods: {\n    ...mapMutations('store_user', ['updateUserInfo', 'updateToken']),\n    async login() {\n      await this.get_subscribeMessage()\n\n      //  获取到用户信息\n      uni.getUserInfo({\n        success: (e) => {\n          console.log(e.userInfo, '::userinfo')\n          //  获取code 并且发送给服务器拿到身份openid。\n          uni.login({\n            success: async (e) => {\n              //  通过code给后端换取身份。\n              const code = e.code\n              const resLogin = await uni.$httpRequest({\n                url: \"my/login\",\n                method: \"post\",\n                data: {code}\n              })\n              //  拿到数据\n              const {data: {code: resultCode, msg, data}} = resLogin\n\n              console.log('::登陆后返回的数据', data)\n              if (resultCode) {\n                //  解析出token和 logon信息\n                const {token, userInfo} = data\n                this.updateToken(token)\n\n                //  更新用户信息\n                this.updateUserInfo(userInfo)\n\n                // 更新用户地址\n                uni.$showMsg('登陆成功！')\n              } else {\n                uni.$showMsg(`登陆失败 ${msg}`)\n              }\n            },\n            fail: err => uni.$showMsg(`登陆失败，${err.errMsg}`)\n          })\n        },\n        fail: err => {\n          uni.$showMsg(`获取用户信息失败，${err.errMsg}`)\n          console.error(err)\n        }\n      })\n\n    },\n    // 获取通知权限\n    get_subscribeMessage() {\n      return new Promise((resolve, reject) => {\n        console.log(\"::tmplIds\", this.subscribeMessages_templIDs)\n\n        uni.requestSubscribeMessage({\n          tmplIds: this.subscribeMessages_templIDs,\n          success: (res) => {\n            console.log('==【订阅消息】授权成功通知：', res)\n            resolve(res)\n          },\n          fail: (e) => {\n            console.log('==【订阅消息】授权失败通知', e)\n            resolve(e)\n          }\n        })\n      })\n    }\n  },\n  mounted() {\n  }\n}\n</script>\n\n<style lang='scss'>\n.content {\n  text-align: center;\n}\n\n.header {\n  height: 50vh;\n  //  居中\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.headImg {\n  width: 50vw;\n  height: 50vw;\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.container {\n  padding: 15px;\n\n  .text {\n    color: rgb(144, 164, 174);\n    width: 100vw;\n    font-size: 25rpx;\n    position: absolute;\n    bottom: 5px;\n  }\n}\n</style>\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./loginNo.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./loginNo.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1697817426243\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}